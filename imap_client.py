#!/bin/python3

import imaplib
import sys

if len(sys.argv) < 4:
    print('VocÃª precisa rodar o script da forma correta: python3 imap_client.py imap-server endereco-email senha')
    sys.exit()

with imaplib.IMAP4(sys.argv[1]) as M:
    M.login(sys.argv[2], sys.argv[3])
    print('--------------INBOX------------')
    M.select()
    typ, data = M.search(None, 'ALL')
    for num in data[0].split():
        typ, data = M.fetch(num, '(RFC822)')
        print('Message %s\n%s\n' % (num, data[0][1]))

    print('--------------INBOX SENT------------')
    M.select('INBOX.Sent')
    typ, data = M.search(None, 'ALL')
    for num in data[0].split():
        typ, data = M.fetch(num, '(RFC822)')
        print('Message %s\n%s\n' % (num, data[0][1]))


    M.noop()
    M.close()
    M.logout()
