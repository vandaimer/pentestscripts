import requests
import sys
import os

if len(sys.argv) > 1:
    ip = sys.argv[1]
    data = requests.get("https://rdap.db.ripe.net/ip/" + ip)
    if data.status_code == 200:
        data = data.json()
        startAddress = data.get('startAddress')
        endAddress = data.get('endAddress')
        firstIp = int(startAddress.split('.')[-1])
        lastIp = int(endAddress.split('.')[-1])
        list_of_ips = range(firstIp, lastIp+1)
        for item in list_of_ips:
            new_ip = ip.split('.')
            new_ip[-1] = str(item)
            new_ip = '.'.join(new_ip)
            res = os.system('host -t cname %s' % (new_ip,))
            print(res)
    else:
        print('Not found')
else:
    print('Please, run the program like this: python3 infra-mapping.py IP')
