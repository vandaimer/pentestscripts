#!/bin/bash

if [ "$1" == "" ]; then
    echo "Find domains from Main Domain"
    echo "Execute $0 maindomain.com.br"
else
    for i in {1..25}; do echo -n '-'; done
    echo
    printf "  Buscando Hosts...\n"
    for i in {1..25}; do echo -n '-'; done
    echo

    page=$(wget -qO- $1)
    domains=$(echo "$page" | grep -o '<a.*http\(s\)\?://\(www.\)\?[^"]*' | awk -F / '{print $3}' | sort -u)

    for domain in $domains
    do
        echo "$domain"
    done

    for i in {1..25}; do echo -n '-'; done
    echo
    printf "  Resolvendo Hosts...\n"
    for i in {1..25}; do echo -n '-'; done
    echo

    for domain in $domains
    do
        host "$domain" | grep 'has address' | awk -F ' ' '{print $1 " - " $4}'
    done
fi;
