#!/usr/bin/python

import socket
import sys
import re

if len(sys.argv) != 3:
    print('Execute: python %s host wordlistuser' % sys.argv[0])
    exit(1)

host = sys.argv[1]
with open(sys.argv[2], 'r') as file:
    m_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    m_socket.connect((host, 25))
    m_socket.recv(1024)

    for line in file:
        m_socket.send(b'VRFY %s\r\n' % line)
        response = m_socket.recv(1024)
        if re.search('252', response):
            print('Usuário válido: %s', line)
